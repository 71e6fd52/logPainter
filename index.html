<!doctypehtml><html lang=zh-CN><title>QQ跑团记录着色器</title><meta content="text/html; charset=utf-8"http-equiv=Content-Type><meta content="width=device-width,initial-scale=0.8"name=viewport><meta content=QQ跑团记录着色器 name=Description><meta content=#D1EAF7 name=theme-color><script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.bundle.min.js></script><link href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css rel=stylesheet><link href=color-picker.min.css rel=stylesheet><script src=color-picker.min.js></script><link href=favicon.ico rel="shortcut icon"><script src="https://www.googletagmanager.com/gtag/js?id=UA-124322134-3"async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-124322134-3")</script><script src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js async data-ad-client=ca-pub-6328033898902108></script><style>body{background-color:#d1eaf7;transition:background-color 1.5s ease}#div_page{margin:50px}#div_nav{margin:10px}#div_names{margin-bottom:20px;margin-left:50px;margin-right:50px;margin-top:20px}.button_player{text-align:left;width:100%}#textarea_log_input{height:300px;text-align:left}#div_log_output{float:left;width:100%}#textarea_log_output{height:300px;width:100%}.button_controller,.button_filter{height:50px;width:155px}#div_log_view{background-color:#d1eaf7;float:left;overflow:auto;width:100%}.div_center{text-align:center}.div_italic{font-style:italic}#div_button{margin:10px}.input_name{background:0 0;border:0;height:34px;width:inherit}</style><body><!--[if lt IE 10]><div id=div_browser_warning style=background-color:#979797><h2 style="color:#fff;text-align:center;margin:10px 0 10px 0;padding:15px">你的浏览器已严重过时, 请升级到新版本IE或使用Chrome浏览器</h2></div><![endif]--><div id=div_nav><nav class="bg-light navbar navbar-expand-md navbar-light"><a href=# class=navbar-brand><img alt=""height=30 src=favicon.ico width=30> </a><a href=# class=navbar-brand>Dice! Logpainter</a> <button class=navbar-toggler aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation"data-target=#navbarSupportedContent data-toggle=collapse type=button><span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse"id=navbarSupportedContent><ul class="mr-auto navbar-nav"><li class=nav-item><a href=https://kokona.tech class=nav-link>Dice! 主站</a><li class=nav-item><a href=https://github.com/w4123/logpainter class=nav-link>本项目GitHub</a><li class=nav-item><a href=https://github.com/w4123/trpglogger class=nav-link>跑团记录器</a></ul></div></nav></div><div id=div_page><div><div class=div_center><h3 id=header_title>QQ跑团记录着色器</h3><h5 id=header_version>v2.5 by 风羽(溯洄改)</h5></div><div class=div_italic><a href=http://aligo.github.io/log-colourer.js>前辈的mirc版传送门</a><br><a href=javascript:void(0); id=specialMode1>艾德琳的文本着色器</a> <a href=javascript:void(0); id=defaultMode>QQ跑团记录着色器</a></div><h6>将QQ聊天记录的【文本】复制到下面这个文本框中,然后点击按钮【Analyze】</h6></div><div><textarea class=form-control id=textarea_log_input></textarea></div><div class=div_center id=div_button><div><button class="btn btn-info button_filter"id=button_log_command style=margin-bottom:2px>指令过滤 On</button> <button class="btn btn-info button_filter"id=button_log_other style=margin-bottom:2px>(开头内容过滤 On</button> <button class="btn btn-info button_filter"id=button_log_pic_text style=margin-bottom:2px>[图片]过滤 On</button> <button class="btn btn-info button_filter"id=button_log_time style=margin-bottom:2px>显示时间 On</button> <button class="btn btn-info button_filter"id=button_log_nname style=margin-bottom:2px>人名头衔过滤 On</button></div><br><div><button class="btn button_controller btn-success"id=button_log_analyze style=margin-bottom:2px>Analyze</button> <button class="btn button_controller btn-warning"id=button_log_clear style=margin-bottom:2px>清除输入</button> <button class="btn button_controller btn-success"id=button_palette style=margin-bottom:2px;display:none>使用调色盘</button> <button class="btn button_controller btn-success"id=button_share style=margin-bottom:2px;display:none>分享到Dice!论坛</button></div></div><br><div class=div_center></div><div id=div_names></div><div id=div_log><h6>复制预览部分内容可得TXT文本(双击以选中所有文本)，输出部分为论坛用代码</h6><ul class="nav nav-tabs"role=tablist><li class=nav-item role=presentation style=background-color:#f6ffbe;border-radius:5px;width:50%><a href=#div_log_view class="nav-link active show"aria-controls=div_log_view data-toggle=tab role=tab>预览</a><li class=nav-item role=presentation style=background-color:#f6ffbe;border-radius:5px;width:50%><a href=#div_log_output class=nav-link aria-controls=div_log_output data-toggle=tab role=tab>输出</a></ul><div class=tab-content style=display:flex><div class="active show fade tab-pane"id=div_log_view role=tabpanel style=background-color:#fff></div><div class="fade tab-pane"id=div_log_output role=tabpanel><textarea class=form-control id=textarea_log_output></textarea></div></div></div></div><script id=html_player_grid type=html/template><div class="col-sm-2"><input type="text" class="font-control input_name" name="&id" value="&name" placeholder="删除消息请点右边开关"></div><div class="col-sm-2" style="min-width: 150px">&select</div><div class="col-sm-1" style="min-width: 80px"><button style="text-align: center" type="button" class="btn btn-success button_player" name="&id">On</button></div><div class="col-sm-1"></div></script><div class="container-fluid div_center"><script src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js async></script><ins class=adsbygoogle data-ad-client=ca-pub-6328033898902108 data-ad-format=auto data-ad-slot=7844798489 data-full-width-responsive=true style=display:block></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class=div_footer><footer class="container-fluid foot-wrap"><p style=text-align:center;margin-top:20px;color:#878b91>原作者:风羽 Copyright ©2017-2019 hina.moe<br>修改: 溯洄 Copyright ©2018-2019 kokona.tech</footer></div><script>!function(_,a,t){_("#specialMode1").click(function(){_("body").css("background-color","#f0e4f7"),_("#div_log_view").css("background-color","#ffffff"),_("#header_title").fadeOut("fast",function(){_("#header_title").text("艾德琳的文本着色器"),_("#header_title").fadeIn()}),_("#header_version").fadeOut("slow",function(){_("#header_version").text("v1.2 by 风羽(溯洄改)"),_("#header_version").fadeIn()}),_("#specialMode1").hide(),_("#defaultMode").show(),e=1,c=!0,_("#button_palette").text("使用论坛颜色"),_("#div_log_view").css("background-color","#ffffff"),g=[],m=[],_("html,body").animate({scrollTop:1},"fast"),_("#div_log").fadeOut("fast"),_("#button_palette").hide(),_("#button_share").hide(),_("#div_names").html("")}),_("#defaultMode").click(function(){_("body").css("background-color","#D1EAF7"),_("#div_log_view").css("background-color",""),_("#header_title").fadeOut("fast",function(){_("#header_title").text("QQ跑团记录着色器"),_("#header_title").fadeIn()}),_("#header_version").fadeOut("slow",function(){_("#header_version").text("v2.5 by 风羽(溯洄改)"),_("#header_version").fadeIn()}),_("#defaultMode").hide(),_("#specialMode1").show(),e=0,c=!1,_("#button_palette").text("使用调色盘"),_("#div_log_view").css("background-color",""),g=[],m=[],_("html,body").animate({scrollTop:1},"fast"),_("#div_log").fadeOut("fast"),_("#button_palette").hide(),_("#button_share").hide(),_("#div_names").html("")}),_(t).ready(function(){_("#div_log").hide(),_("#button_palette").hide(),_("#button_share").hide(),_("#defaultMode").hide();var t=function(t){for(var e=a.location.search.substring(1).split("&"),n=0;n<e.length;n++){var o=e[n].split("=");if(o[0]==t)return o[1]}return!1}("s3");t?_.ajax({url:"https://dicelogger.s3-accelerate.amazonaws.com/"+t,tryCount:0,retryLimit:3,success:function(t){_("#textarea_log_input").val(t),_("#button_log_analyze").click()},error:function(t,e,n){if("timeout"==e)return this.tryCount++,this.tryCount<=this.retryLimit?void _.ajax(this):void 0;_("#textarea_log_input").val("获取跑团日志失败! 请刷新重试!")}}):""!=_("#textarea_log_input").val()&&_("#button_log_analyze").click()}),_("#button_log_command").click(function(){(p=!p)?(_(this).addClass("btn-info"),_(this).text("指令过滤 On"),_(this).removeClass("btn-warning")):(_(this).removeClass("btn-info"),_(this).text("指令过滤 Off"),_(this).addClass("btn-warning"))}),_("#button_log_other").click(function(){(b=!b)?(_(this).addClass("btn-info"),_(this).text("(开头内容过滤 On"),_(this).removeClass("btn-warning")):(_(this).removeClass("btn-info"),_(this).text("(开头内容过滤 Off"),_(this).addClass("btn-warning"))}),_("#button_log_pic_text").click(function(){(w=!w)?(_(this).addClass("btn-info"),_(this).text("[图片]过滤 On"),_(this).removeClass("btn-warning")):(_(this).removeClass("btn-info"),_(this).text("[图片]过滤 Off"),_(this).addClass("btn-warning"))}),_("#button_log_time").click(function(){(r=!r)?(_(this).addClass("btn-info"),_(this).text("显示时间 On"),_(this).removeClass("btn-warning")):(_(this).removeClass("btn-info"),_(this).text("显示时间 Off"),_(this).addClass("btn-warning"))}),_("#button_log_nname").click(function(){(y=!y)?(_(this).addClass("btn-info"),_(this).text("人名头衔过滤 On"),_(this).removeClass("btn-warning")):(_(this).removeClass("btn-info"),_(this).text("人名头衔过滤 Off"),_(this).addClass("btn-warning"))}),_("#button_log_clear").click(function(){_("html,body").animate({scrollTop:1},"fast"),g=[],m=[],_("#div_log").fadeOut("fast"),_("#button_palette").hide(),_("#button_share").hide(),_("#textarea_log_input").val(""),_("#div_names").html("")}),_("#div_log_view").dblclick(function(){!function(t){var e;(e=document.createRange()).selectNode(document.getElementById(t));var n=window.getSelection();n.removeAllRanges(),n.addRange(e)}(this.id)}),_("#textarea_log_output").click(function(){_(this).select()}),_("#button_palette").click(function(){c=!c,h(),c?(_(this).text("使用论坛颜色"),_("#div_log_view").css("background-color","#ffffff"),_("#button_share").hide()):(_(this).text("使用调色盘"),_("#div_log_view").css("background-color",""),_("#button_share").fadeTo("slow",.7),v())}),_("#button_share").click(function(){s=_("#textarea_log_output").val(),!c&&s&&window.open("https://forum.kokona.tech/composer?title=%E8%B7%91%E5%9B%A2%E8%AE%B0%E5%BD%95%E5%88%86%E4%BA%AB&tag=water&content="+encodeURIComponent(s))});var g=[],m=[],o="red;green;pink;orange;purple;black;blue;yellow;beige;brown;teal;navy;maroon;limegreen;white;fuchsia;silver".split(";"),i="红色;绿色;粉红;橘色;紫色;黑色;蓝色;黄色;米色;棕色;蓝绿;深蓝;紫红;莱姆;白色;桃红;灰色".split(";"),l="silver",p=!0,b=!0,w=!0,r=!0,c=!1,y=!0,e=0;function n(t,e){this.name=t,this.color=o[e],this.valid=!0}function x(t,e,n){this.time=t,this.player=e,this.content=n}function k(t){for(var e=0;e<g.length;e++)if(g[e].name==t)return!0;return!1}function C(t,e){g[g.length]=new n(t,e)}function O(t){for(var e=0;e<g.length;e++)if(g[e].name==t)return g[e];return null}function d(){_("select").change(function(){var t=_(this).val(),e=parseInt(_(this).attr("name"));_(this).css("background-color",t),f(e,t)}),_(".input_name").change(function(){var t=_(this).val(),e=parseInt(_(this).attr("name"));g[e].name=t,v()}),function(){for(var t=0;t<g.length;t++){var e="#select_"+t,n=o[t];g[t].color=n,_(e).val(n),_(e).css("background-color",n)}}()}function u(t,e){return c?_("#html_player_grid").html().replace(/&name/g,e).replace(/&id/g,t).replace("&select",function(t){return'<input class = "form-control palette" name = "'+t+'" id ="palette_'+t+'" type="text">'}(t)):_("#html_player_grid").html().replace(/&name/g,e).replace(/&id/g,t).replace("&select",function(t){var e="";e+='<select name ="'+t+'" id ="select_'+t+'" class="form-control">';for(var n=0;n<i.length;n++)e+='<option value="'+o[n]+'" style="background-color:'+o[n]+';">'+i[n]+"</option>";return e+="</select>"}(t))}function h(){var t,e='<div class="div_center div_italic" style="color:red"><p>出现的PC名字 (点击可以修改)</p><br></div>';for(t=0;t<g.length;t++)t%2==0&&(e+='<div class="row">'),e+=u(t,g[t].name),t%2==1&&(e+="</div>");t%2==0&&(e+="</div>"),_("#div_names").html(e),c?(_(".palette").each(function(){var t=new a.CP(this);t.on("change",function(t){var e="#"+t;this.source.value=e,_(this.source).css("background-color",e),f(this.source.name,e)}),_(this).click(function(){_(this).select()}),_(this).change(function(){t.set(a.CP.parse(_(this).val()))})}),_(".input_name").change(function(){var t=_(this).val(),e=parseInt(_(this).attr("name"));g[e].name=t,v()})):d(),_("#button_palette").fadeTo("slow",.7),_("#button_share").fadeTo("slow",.7),_(".button_player").click(function(){(function(t){return g[t].valid=!g[t].valid,v(),g[t].valid})(parseInt(_(this).attr("name")))?(_(this).addClass("btn-success"),_(this).text("On"),_(this).removeClass("btn-default")):(_(this).removeClass("btn-success"),_(this).text("Off"),_(this).addClass("btn-default"))})}function f(t,e){g[t].color=e,g[t].valid&&v()}function v(){switch(e){case 1:!function(){for(var t="",e="",n=0;n<m.length;n++){var o=m[n].player.color,a=m[n].player.name,i=m[n].content;0==m[n].player.valid&&"旁白"!=a&&(a="",o=O("旁白").color,i=m[n].player.name+"："+m[n].content),"旁白"==a?a="":""!=a&&(a+="："),t+="[color="+o+"]"+a,t+=i,t+="[/color]\n",e+='<span style="color:'+o+';">'+a,e+=i,e+="</span><br>"}c&&(t="调色盘模式下的颜色不兼容论坛代码，请双击全选预览中的文字，复制粘贴到Word中保存"),_("#textarea_log_output").val(t),_("#div_log_view").html(e)}();break;default:!function(){for(var t="",e="",n=0;n<m.length;n++)if(0!=m[n].player.valid){var o=m[n].player.color,a=m[n].player.name;r&&(t+="[color="+l+"]"+m[n].time+"[/color] "),t+="[color="+o+"]<"+m[n].player.name+"> ",t+=m[n].content,t+="[/color]\n",r&&(e+='<span style="color:'+l+';">'+m[n].time+"</span> "),e+='<span style="color:'+o+';">&lt;'+a+"&gt; ",e+=m[n].content,e+="</span><br>"}c&&(t="调色盘模式下的颜色不兼容论坛代码，请双击全选预览中的文字，复制粘贴到Word中保存"),_("#textarea_log_output").val(t),_("#div_log_view").html(e)}()}}_("#button_log_analyze").click(function(){var t;switch(""!=_("#textarea_log_input").val()&&_("html,body").animate({scrollTop:_("#div_names").offset().top},500),e){case 1:t=function(){g=[],m=[],_("#div_names").html(""),_("#div_log").hide();var t,e,n=/(.+?)[:：](.*)/,o=_("#textarea_log_input").val().split("\n"),a=0;C("旁白",0);for(var i=0;i<o.length;i++){var l,s=o[i].match(n);l=null!=s?(t=s[1].trim(),e=s[2],""!=t&&(k(t)||(C(t,a),a++)),new x("",O(t),e)):new x("",O("旁白"),o[i]),m[m.length]=l}return g.length}();break;default:t=function(){g=[],m=[],_("#div_names").html(""),_("#div_log").hide();for(var t=/\d{4}(?:-|\/)\d{1,2}(?:-|\/)\d{1,2} (\d{1,2}:\d{2}:\d{2}) (AM|PM)? ?([^\(]*)/,e=/(.*?)(\([0-9]+\))? +\d{4}(?:-|\/)\d{1,2}(?:-|\/)\d{1,2} +(\d{1,2}:\d{2}:\d{2}).*/,n=/(.*?)(\([0-9]+\))? +(\d{1,2}:\d{2}:\d{2}).*/,o=/^([\.。!！][rR]|[/\.、。!！][mM][eE]|[\.。!！][hH][eE][lL][pP]|[\.。!！][lL][oO][gG]|[\.。!！][wW]|[\.。!！][sS][cC]|[\.。!！][eE][nN]|[\.。!！][sS][eE][tT]|[\.。!！][sS][tT]|[\.。!！][cC][oO][cC]|[\.。!！][dD][nN][dD]|[\.。!！][tTlL][iI]|[\.。!！][jJ][rR][rR][pP]|[\.。!！][rR][uU][lL][eE][sS]|[\.。!！][nN]|[\.。!！][bB][oO][tT]|[\.。!！][oO][bB]|[\.。!！][wW][eE][lL][cC][oO][mM][eE]).*/,a=/^(\(|（).*/,i=/\[图片\]/,l=_("#textarea_log_input").val().split("\n"),s="",r="",c=0,d=0;d<l.length;d++)if(0!=l[d].length){var u=l[d].match(t),h=l[d].match(e),f=l[d].match(n);if(null!=u||null!=h||null!=f)null!=u?(s=u[3].trim(),r=u[1]):null!=h?(s=h[1].trim(),r=h[3]):null!=f&&(s=f[1].trim(),r=f[3]),y&&0==s.indexOf("【")&&-1!=s.indexOf("】")&&(s=s.substr(s.indexOf("】")+1)),""!=s&&"系统消息"!=s&&(k(s)||(C(s,c),c++));else{if(""==s)continue;if("系统消息"==s)continue;if(p&&null!=l[d].match(o))continue;if(b&&null!=l[d].match(a))continue;if(w&&(l[d]=l[d].replace(i,""),0==l[d].length))continue;8!=r.length&&(r=" "+r);var v=new x(r,O(s),l[d]);m[m.length]=v}}return g.length}()}0<t?(h(),v(),_("#div_log").show()):(_("#div_log").hide(),_("#button_palette").hide(),_("#button_share").hide(),_("#defaultMode").hide(),_("#div_names").html('<div class="div_center div_italic" style="color:red"><p>无法识别聊天记录文本，请确认输入格式正确</p></div>'))})}(jQuery,window,document)</script>